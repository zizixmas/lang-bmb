-- Tests for stdlib/string module
-- Verifies string utility functions

use string::char_is_whitespace;
use string::char_is_digit;
use string::char_is_lower;
use string::char_is_upper;
use string::char_is_alpha;
use string::char_to_upper;
use string::char_to_lower;
use string::digit_to_int;
use string::starts_with;
use string::ends_with;
use string::index_of_char;
use string::parse_uint;
use string::string_eq;
use string::is_blank;

-- Test character classification
fn test_char_is_whitespace_space() -> bool
  post ret == true
= char_is_whitespace(32);

fn test_char_is_whitespace_tab() -> bool
  post ret == true
= char_is_whitespace(9);

fn test_char_is_whitespace_letter() -> bool
  post ret == false
= char_is_whitespace(65);

fn test_char_is_digit_zero() -> bool
  post ret == true
= char_is_digit(48);

fn test_char_is_digit_nine() -> bool
  post ret == true
= char_is_digit(57);

fn test_char_is_digit_letter() -> bool
  post ret == false
= char_is_digit(65);

fn test_char_is_lower_a() -> bool
  post ret == true
= char_is_lower(97);

fn test_char_is_lower_z() -> bool
  post ret == true
= char_is_lower(122);

fn test_char_is_lower_A() -> bool
  post ret == false
= char_is_lower(65);

fn test_char_is_upper_A() -> bool
  post ret == true
= char_is_upper(65);

fn test_char_is_upper_Z() -> bool
  post ret == true
= char_is_upper(90);

fn test_char_is_alpha_letter() -> bool
  post ret == true
= char_is_alpha(97);

fn test_char_is_alpha_digit() -> bool
  post ret == false
= char_is_alpha(48);

-- Test character conversion
fn test_char_to_upper_a() -> i64
  post ret == 65
= char_to_upper(97);

fn test_char_to_upper_A() -> i64
  post ret == 65
= char_to_upper(65);

fn test_char_to_lower_A() -> i64
  post ret == 97
= char_to_lower(65);

fn test_char_to_lower_a() -> i64
  post ret == 97
= char_to_lower(97);

fn test_digit_to_int_0() -> i64
  post ret == 0
= digit_to_int(48);

fn test_digit_to_int_9() -> i64
  post ret == 9
= digit_to_int(57);

-- Test string search
fn test_starts_with_true() -> bool
  post ret == true
= starts_with("hello world", "hello");

fn test_starts_with_false() -> bool
  post ret == false
= starts_with("hello world", "world");

fn test_starts_with_empty() -> bool
  post ret == true
= starts_with("hello", "");

fn test_ends_with_true() -> bool
  post ret == true
= ends_with("hello world", "world");

fn test_ends_with_false() -> bool
  post ret == false
= ends_with("hello world", "hello");

fn test_index_of_char_found() -> i64
  post ret == 4
= index_of_char("hello", 111);  -- 'o' is 111

fn test_index_of_char_not_found() -> i64
  post ret == -1
= index_of_char("hello", 120);  -- 'x' is 120

-- Test parsing
fn test_parse_uint_valid() -> i64
  post ret == 123
= parse_uint("123");

fn test_parse_uint_zero() -> i64
  post ret == 0
= parse_uint("0");

fn test_parse_uint_empty() -> i64
  post ret == -1
= parse_uint("");

-- Test string comparison
fn test_string_eq_true() -> bool
  post ret == true
= string_eq("hello", "hello");

fn test_string_eq_false() -> bool
  post ret == false
= string_eq("hello", "world");

fn test_string_eq_different_length() -> bool
  post ret == false
= string_eq("hello", "hello world");

-- Test utilities
fn test_is_blank_empty() -> bool
  post ret == true
= is_blank("");

fn test_is_blank_spaces() -> bool
  post ret == true
= is_blank("   ");

fn test_is_blank_text() -> bool
  post ret == false
= is_blank("hello");

-- Main test runner
fn main() -> i64 =
    let t1 = test_char_is_whitespace_space();
    let t2 = test_char_is_digit_zero();
    let t3 = test_char_to_upper_a();
    let t4 = test_starts_with_true();
    let t5 = test_parse_uint_valid();
    let t6 = test_string_eq_true();
    0;
